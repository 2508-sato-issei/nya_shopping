<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>商品編集画面</title>
    <link rel="stylesheet" th:href="@{/css/admin.css}">
</head>
<body>

<header class="admin-header">
    <h1>商品編集</h1>
    <nav>
        <a th:href="@{/admin/products}">商品一覧へ戻る</a>
    </nav>
</header>

<main class="container">

    <!-- エラー表示 -->
<!--    <div th:if="${#fields.hasErrors()}" class="error-box">-->
<!--        <ul>-->
<!--            <li th:each="err : ${#fields.errors('*')}" th:text="${err}"></li>-->
<!--        </ul>-->
<!--    </div>-->

    <!-- 編集フォーム -->
    <form th:action="@{'/admin/products/' + ${productForm.id}}"
          th:object="${productForm}"
          method="post"
          enctype="multipart/form-data"
          class="form-box">

        <!-- ID hidden -->
        <input type="hidden" th:field="*{id}"/>

        <!-- 商品名 -->
        <div class="form-group">
            <label>商品名</label>
            <input type="text" th:field="*{name}">
            <div class="error" th:errors="*{name}"></div>
        </div>

        <!-- 価格 -->
        <div class="form-group">
            <label>価格（円）</label>
            <input type="number" th:field="*{price}" min="0">
            <div class="error" th:errors="*{price}"></div>
        </div>

        <!-- 在庫 -->
        <div class="form-group">
            <label>在庫数</label>
            <input type="number" th:field="*{stock}" min="0">
            <div class="error" th:errors="*{stock}"></div>
        </div>

        <!-- カテゴリ -->
        <div class="form-group">
            <label>カテゴリ</label>
            <select th:field="*{category}">
                <option th:each="c : ${categories}"
                        th:value="${c}"
                        th:text="${c}"
                        th:selected="${c == productForm.category}">
                </option>
            </select>
            <div class="error" th:errors="*{category}"></div>
        </div>

        <!-- 説明文 -->
        <div class="form-group">
            <label>商品説明</label>
            <textarea th:field="*{description}" rows="6"></textarea>
            <div class="error" th:errors="*{description}"></div>
        </div>

        <!-- 画像（プレビューつき） -->
        <div class="form-group">
            <label>現在の画像</label>
            <div>
                <img th:if="${productForm.imageUrl}" th:src="@{${productForm.imageUrl}}" class="thumb-large">
                <span th:if="${productForm.imageUrl == null}">画像なし</span>
            </div>
        </div>

        <div class="form-group">
            <label>画像を変更する（任意）</label>
            <input type="file" th:field="*{imageFile}" accept="image/png,image/jpeg">
            <div class="error" th:errors="*{imageFile}"></div>
            <p class="note">※ 空のままなら画像は変更されません</p>
        </div>

        <!-- 更新ボタン -->
        <div class="form-button">
            <button type="submit" class="btn-primary">更新する</button>
            <a th:href="@{/admin/products}" class="btn-secondary">キャンセル</a>
        </div>
    </form>

</main>

</body>
</html>